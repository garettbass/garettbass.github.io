import{r as t,e,h as i,H as n,d as s}from"./p-ed98ce0b.js";import{g as r}from"./p-a19aa8c2.js";import{a as o,e as a,f as h,h as d}from"./p-6f155354.js";import"./p-f2660943.js";import{p as l}from"./p-0e917e13.js";import{h as m}from"./p-7840618d.js";const u=(t,e,i,n)=>{if(t!==O&&t!==A){if(t===Z)return void 0!==i&&void 0!==i.hour?i.hour<12?"AM":"PM":e?e.toUpperCase():"";if(t===E)return void 0!==i&&void 0!==i.hour?i.hour<12?"am":"pm":e||"";if(null==e)return"";if(t===Y||t===I||t===F||t===T||t===H||t===V)return k(e);if(t===$)return S(e);if(t===C)return(n.monthNames?n.monthNames:U)[e-1];if(t===j)return(n.monthShortNames?n.monthShortNames:L)[e-1];if(t===J||t===z){if(0===e)return"12";if(e>12&&(e-=12),t===J&&e<10)return"0"+e}return e.toString()}try{return e=new Date(i.year,i.month-1,i.day).getDay(),t===O?(n.dayNames?n.dayNames:W)[e]:(n.dayShortNames?n.dayShortNames:B)[e]}catch(s){}},f=(t,e,i,n=0,s=0)=>parseInt(`1${S(t)}${k(e)}${k(i)}${k(n)}${k(s)}`,10),p=t=>f(t.year,t.month,t.day,t.hour,t.minute),c=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/,v=/^((\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/,g=t=>{let e=null;if(null!=t&&""!==t&&(e=v.exec(t),e?(e.unshift(void 0,void 0),e[2]=e[3]=void 0):e=c.exec(t)),null===e)return;for(let n=1;n<8;n++)e[n]=void 0!==e[n]?parseInt(e[n],10):void 0;let i=0;return e[9]&&e[10]&&(i=60*parseInt(e[10],10),e[11]&&(i+=parseInt(e[11],10)),"-"===e[9]&&(i*=-1)),{year:e[1],month:e[2],day:e[3],hour:e[4],minute:e[5],second:e[6],millisecond:e[7],tzOffset:i}},y=(t,e)=>{const i=new Date(t.toLocaleString("en-US",{timeZone:"utc"})),n=new Date(t.toLocaleString("en-US",{timeZone:e}));return i.getTime()-n.getTime()},b=(t,e)=>e===Z||e===E?t.hour<12?"am":"pm":e===J||e===z?t.hour>12?t.hour-12:0===t.hour?12:t.hour:t[x(e)],x=t=>{for(const e in P)if(P[e].f===t)return P[e].k},M=t=>{let e="";return void 0!==t.year?(e=S(t.year),void 0!==t.month&&(e+="-"+k(t.month),void 0!==t.day&&(e+="-"+k(t.day),void 0!==t.hour&&(e+=`T${k(t.hour)}:${k(t.minute)}:${k(t.second)}`,t.millisecond>0&&(e+="."+N(t.millisecond)),e+=void 0===t.tzOffset?"Z":(t.tzOffset>0?"+":"-")+k(Math.floor(Math.abs(t.tzOffset/60)))+":"+k(t.tzOffset%60))))):void 0!==t.hour&&(e=k(t.hour)+":"+k(t.minute),void 0!==t.second&&(e+=":"+k(t.second),void 0!==t.millisecond&&(e+="."+N(t.millisecond)))),e},D=(t,e)=>{if(null==t)return;let i;return"string"==typeof t&&(t=t.replace(/\[|\]/g,"").split(",")),Array.isArray(t)&&(i=t.map(t=>t.toString().trim())),void 0!==i&&0!==i.length||console.warn(`Invalid "${e}Names". Must be an array of strings, or a comma separated string.`),i},w=(t,e)=>{let i;return"string"==typeof t&&(t=t.replace(/\[|\]|\s/g,"").split(",")),i=Array.isArray(t)?t.map(t=>parseInt(t,10)).filter(isFinite):[t],0===i.length&&console.warn(`Invalid "${e}Values". Must be an array of numbers, or a comma separated string of numbers.`),i},k=t=>("0"+(void 0!==t?Math.abs(t):"0")).slice(-2),N=t=>("00"+(void 0!==t?Math.abs(t):"0")).slice(-3),S=t=>("000"+(void 0!==t?Math.abs(t):"0")).slice(-4),$="YYYY",Y="YY",C="MMMM",j="MMM",I="MM",O="DDDD",A="DDD",F="DD",T="HH",J="hh",z="h",H="mm",V="ss",Z="A",E="a",P=[{f:$,k:"year"},{f:C,k:"month"},{f:O,k:"day"},{f:j,k:"month"},{f:A,k:"day"},{f:Y,k:"year"},{f:I,k:"month"},{f:F,k:"day"},{f:T,k:"hour"},{f:J,k:"hour"},{f:H,k:"minute"},{f:V,k:"second"},{f:"M",k:"month"},{f:"D",k:"day"},{f:"H",k:"hour"},{f:z,k:"hour"},{f:"m",k:"minute"},{f:"s",k:"second"},{f:Z,k:"ampm"},{f:E,k:"ampm"}],W=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],B=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],U=["January","February","March","April","May","June","July","August","September","October","November","December"],L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],R=[J,z,H,"m",V,"s"],_=class{constructor(i){t(this,i),this.inputId=`ion-dt-${K++}`,this.locale={},this.datetimeMin={},this.datetimeMax={},this.datetimeValue={},this.isExpanded=!1,this.name=this.inputId,this.disabled=!1,this.readonly=!1,this.displayFormat="MMM D, YYYY",this.cancelText="Cancel",this.doneText="Done",this.onClick=()=>{this.setFocus(),this.open()},this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.ionCancel=e(this,"ionCancel",7),this.ionChange=e(this,"ionChange",7),this.ionFocus=e(this,"ionFocus",7),this.ionBlur=e(this,"ionBlur",7),this.ionStyle=e(this,"ionStyle",7)}disabledChanged(){this.emitStyle()}valueChanged(){this.updateDatetimeValue(this.value),this.emitStyle(),this.ionChange.emit({value:this.value})}componentWillLoad(){this.locale={monthNames:D(this.monthNames,"monthNames"),monthShortNames:D(this.monthShortNames,"monthShortNames"),dayNames:D(this.dayNames,"dayNames"),dayShortNames:D(this.dayShortNames,"dayShortNames")},this.updateDatetimeValue(this.value),this.emitStyle()}async open(){if(this.disabled||this.isExpanded)return;const t=this.generatePickerOptions(),e=await l.create(t);this.isExpanded=!0,e.onDidDismiss().then(()=>{this.isExpanded=!1,this.setFocus()}),o(e,"ionPickerColChange",async t=>{const i=t.detail,n={};n[i.name]={value:i.options[i.selectedIndex].value},"ampm"!==i.name&&void 0!==this.datetimeValue.ampm&&(n.ampm={value:this.datetimeValue.ampm}),this.updateDatetimeValue(n),e.columns=this.generateColumns()}),await e.present()}emitStyle(){this.ionStyle.emit({interactive:!0,datetime:!0,"has-placeholder":null!=this.placeholder,"has-value":this.hasValue(),"interactive-disabled":this.disabled})}updateDatetimeValue(t){((t,e,i)=>{if(!e||"string"==typeof e){const t=((t="",e="")=>{null==t&&(t=""),10!==t.length&&7!==t.length&&4!==t.length||(t+=" ");const i="string"==typeof t&&t.length>0?new Date(t):new Date,n=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()));return e&&e.length>0?new Date(i.getTime()-y(n,e)):n})(e,i);Number.isNaN(t.getTime())||(e=t.toISOString())}if(e&&""!==e){if("string"==typeof e){if(e=g(e))return Object.assign(t,e),!0}else{if(e.year||e.hour||e.month||e.day||e.minute||e.second){void 0!==e.ampm&&void 0!==e.hour&&(e.hour.value="pm"===e.ampm.value?12===e.hour.value?12:e.hour.value+12:12===e.hour.value?0:e.hour.value);for(const i of Object.keys(e))t[i]=e[i].value;return!0}if(e.ampm)return e.hour={value:e.hour?e.hour.value:"pm"===e.ampm.value?t.hour<12?t.hour+12:t.hour:t.hour>=12?t.hour-12:t.hour},t.hour=e.hour.value,t.ampm=e.ampm.value,!0}console.warn(`Error parsing date: "${e}". Please provide a valid ISO 8601 datetime format: https://www.w3.org/TR/NOTE-datetime`)}else for(const n in t)t.hasOwnProperty(n)&&delete t[n]})(this.datetimeValue,t,this.displayTimezone)}generatePickerOptions(){const t=r(this);this.locale={monthNames:D(this.monthNames,"monthNames"),monthShortNames:D(this.monthShortNames,"monthShortNames"),dayNames:D(this.dayNames,"dayNames"),dayShortNames:D(this.dayShortNames,"dayShortNames")};const e=Object.assign(Object.assign({mode:t},this.pickerOptions),{columns:this.generateColumns()}),i=e.buttons;return i&&0!==i.length||(e.buttons=[{text:this.cancelText,role:"cancel",handler:()=>{this.updateDatetimeValue(this.value),this.ionCancel.emit()}},{text:this.doneText,handler:t=>{this.updateDatetimeValue(t);const e=new Date(M(this.datetimeValue));this.datetimeValue.tzOffset=void 0!==this.displayTimezone&&this.displayTimezone.length>0?y(e,this.displayTimezone)/1e3/60*-1:-1*e.getTimezoneOffset(),this.value=M(this.datetimeValue)}}]),e}generateColumns(){let t=this.pickerFormat||this.displayFormat||G;if(0===t.length)return[];this.calcMinMax(),t=t.replace("DDDD","{~}").replace("DDD","{~}"),-1===t.indexOf("D")&&(t=t.replace("{~}","D")),t=t.replace(/{~}/g,"");const e=(t=>{const e=[];t=t.replace(/[^\w\s]/gi," "),P.forEach(e=>{e.f.length>1&&t.indexOf(e.f)>-1&&t.indexOf(e.f+e.f.charAt(0))<0&&(t=t.replace(e.f," "+e.f+" "))});const i=t.split(" ").filter(t=>t.length>0);return i.forEach((t,n)=>{P.forEach(s=>{if(t===s.f){if((t===Z||t===E)&&(e.indexOf(z)<0&&e.indexOf(J)<0||-1===R.indexOf(i[n-1])))return;e.push(t)}})}),e})(t).map(t=>{const e=x(t);let i;i=this[e+"Values"]?w(this[e+"Values"],e):((t,e,i)=>{const n=[];if(t===$||t===Y){if(void 0===i.year||void 0===e.year)throw new Error("min and max year is undefined");for(let t=i.year;t>=e.year;t--)n.push(t)}else if(t===C||t===j||t===I||"M"===t||t===J||t===z)for(let s=1;s<13;s++)n.push(s);else if(t===O||t===A||t===F||"D"===t)for(let s=1;s<32;s++)n.push(s);else if(t===T||"H"===t)for(let s=0;s<24;s++)n.push(s);else if(t===H||"m"===t)for(let s=0;s<60;s++)n.push(s);else if(t===V||"s"===t)for(let s=0;s<60;s++)n.push(s);else t!==Z&&t!==E||n.push("am","pm");return n})(t,this.datetimeMin,this.datetimeMax);const n=i.map(e=>({value:e,text:u(t,e,void 0,this.locale)})),s=((t,e)=>{const i=b(t,e);if(void 0!==i)return e!==Z&&e!==E||(t.ampm=i),i;const n=g((new Date).toISOString());return b(n,e)})(this.datetimeValue,t),r=n.findIndex(t=>t.value===s);return{name:e,selectedIndex:r>=0?r:0,options:n}}),i=this.datetimeMin,n=this.datetimeMax;return["month","day","hour","minute"].filter(t=>!e.find(e=>e.name===t)).forEach(t=>{i[t]=0,n[t]=0}),this.validateColumns(q(e))}validateColumns(t){const e=new Date,i=p(this.datetimeMin),n=p(this.datetimeMax),s=t.find(t=>"year"===t.name);let r=e.getFullYear();if(s){s.options.find(t=>t.value===e.getFullYear())||(r=s.options[0].value);const t=s.selectedIndex;if(void 0!==t){const e=s.options[t];e&&(r=e.value)}}const o=this.validateColumn(t,"month",1,i,n,[r,0,0,0,0],[r,12,31,23,59]),a=4===(h=o)||6===h||9===h||11===h?30:2===h?(t=>t%4==0&&t%100!=0||t%400==0)(r)?29:28:31;var h;const d=this.validateColumn(t,"day",2,i,n,[r,o,0,0,0],[r,o,a,23,59]),l=this.validateColumn(t,"hour",3,i,n,[r,o,d,0,0],[r,o,d,23,59]);return this.validateColumn(t,"minute",4,i,n,[r,o,d,l,0],[r,o,d,l,59]),t}calcMinMax(){const t=(new Date).getFullYear();if(void 0!==this.yearValues){const t=w(this.yearValues,"year");void 0===this.min&&(this.min=Math.min(...t).toString()),void 0===this.max&&(this.max=Math.max(...t).toString())}else void 0===this.min&&(this.min=(t-100).toString()),void 0===this.max&&(this.max=t.toString());const e=this.datetimeMin=g(this.min),i=this.datetimeMax=g(this.max);e.year=e.year||t,i.year=i.year||t,e.month=e.month||1,i.month=i.month||12,e.day=e.day||1,i.day=i.day||31,e.hour=e.hour||0,i.hour=void 0===i.hour?23:i.hour,e.minute=e.minute||0,i.minute=void 0===i.minute?59:i.minute,e.second=e.second||0,i.second=void 0===i.second?59:i.second,e.year>i.year&&(console.error("min.year > max.year"),e.year=i.year-100),e.year===i.year&&(e.month>i.month?(console.error("min.month > max.month"),e.month=1):e.month===i.month&&e.day>i.day&&(console.error("min.day > max.day"),e.day=1))}validateColumn(t,e,i,n,s,r,o){const h=t.find(t=>t.name===e);if(!h)return 0;const d=r.slice(),l=o.slice(),m=h.options;let u=m.length-1,p=0;for(let a=0;a<m.length;a++){const t=m[a],e=t.value;d[i]=t.value,l[i]=t.value,(t.disabled=e<r[i]||e>o[i]||f(l[0],l[1],l[2],l[3],l[4])<n||f(d[0],d[1],d[2],d[3],d[4])>s)||(u=Math.min(u,a),p=Math.max(p,a))}const c=h.selectedIndex=a(u,h.selectedIndex,p),v=h.options[c];return v?v.value:0}get text(){if(null!=this.value&&0!==this.value.length)return((t,e,i)=>{if(void 0===e)return;const n=[];let s=!1;if(P.forEach((r,o)=>{if(t.indexOf(r.f)>-1){const a="{"+o+"}",h=u(r.f,e[r.k],e,i);s||void 0===h||null==e[r.k]||(s=!0),n.push(a,h||""),t=t.replace(r.f,a)}}),s){for(let e=0;e<n.length;e+=2)t=t.replace(n[e],n[e+1]);return t}})(this.displayFormat||this.pickerFormat||G,this.datetimeValue,this.locale)}hasValue(){return void 0!==this.text}setFocus(){this.buttonEl&&this.buttonEl.focus()}render(){const{inputId:t,text:e,disabled:s,readonly:o,isExpanded:a,el:l,placeholder:u}=this,f=r(this),p=t+"-lbl",c=h(l),v=void 0===e&&null!=u,g=void 0===e?null!=u?u:"":e,y=void 0===e?null!=u?"placeholder":void 0:"text";return c&&(c.id=p),d(!0,l,this.name,this.value,this.disabled),i(n,{onClick:this.onClick,"aria-disabled":s?"true":null,"aria-expanded":`${a}`,"aria-haspopup":"true","aria-labelledby":p,class:{[f]:!0,"datetime-disabled":s,"datetime-readonly":o,"datetime-placeholder":v,"in-item":m("ion-item",l)}},i("div",{class:"datetime-text",part:y},g),i("button",{type:"button",onFocus:this.onFocus,onBlur:this.onBlur,disabled:this.disabled,ref:t=>this.buttonEl=t}))}get el(){return s(this)}static get watchers(){return{disabled:["disabledChanged"],value:["valueChanged"]}}},q=t=>{const e=[];let i,n;for(let s=0;s<t.length;s++){i=t[s],e.push(0);for(const t of i.options)n=t.text.length,n>e[s]&&(e[s]=n)}return 2===e.length?(n=Math.max(e[0],e[1]),t[0].align="right",t[1].align="left",t[0].optionsWidth=t[1].optionsWidth=`${17*n}px`):3===e.length&&(n=Math.max(e[0],e[2]),t[0].align="right",t[1].columnWidth=`${17*e[1]}px`,t[0].optionsWidth=t[2].optionsWidth=`${17*n}px`,t[2].align="left"),t},G="MMM D, YYYY";let K=0;_.style={md:":host{padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);display:-ms-flexbox;display:flex;position:relative;min-width:16px;min-height:1.2em;font-family:var(--ion-font-family, inherit);text-overflow:ellipsis;white-space:nowrap;overflow:hidden;z-index:2}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}:host(.in-item){position:static}:host(.datetime-placeholder){color:var(--placeholder-color)}:host(.datetime-disabled){opacity:0.3;pointer-events:none}:host(.datetime-readonly){pointer-events:none}button{left:0;top:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;position:absolute;width:100%;height:100%;border:0;background:transparent;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none}[dir=rtl] button,:host-context([dir=rtl]) button{left:unset;right:unset;right:0}button::-moz-focus-inner{border:0}.datetime-text{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;-ms-flex:1;flex:1;min-height:inherit;direction:ltr;overflow:inherit}[dir=rtl] .datetime-text,:host-context([dir=rtl]) .datetime-text{direction:rtl}:host{--placeholder-color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));--padding-top:10px;--padding-end:0;--padding-bottom:11px;--padding-start:16px}"};export{_ as ion_datetime}